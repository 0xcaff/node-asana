<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
<head>
  <title>Asana Oauth Example: Browser Popup</title>
  <script src="asana.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
</head>

<body>
<div id="ui"><a href="#" onclick="authorize();">Click to Authorize</a></div>

<script>
  //<![CDATA[

  /**
   * Usage:
   *
   * 1. Create an application in Asana.
   * 2. Set the redirect URI to be a "receiver page" served by your server.
   *    In this example, the receiver page is:
   *    `http://localhost:8338/popup_receiver.html`.
   * 3. Ensure this page and the `asana.js` file exist in the same directory
   *    on your web server (as well as the example receiver page, if using).
   * 4. Copy the app's client ID for use below:
   */
  var CLIENT_ID = YOUR_CLIENT_ID_HERE;
  /*
   * 5. Modify the redirect for use below if necessary.
   */
  var REDIRECT_URI = 'http://localhost:8338/popup_receiver.html';

  var client = Asana.Client.create({
    clientId: CLIENT_ID,
    redirectUri: REDIRECT_URI
  });
  client.useOauth({
    flowType: Asana.auth.PopupFlow
  });

  function authorize() {
    $('#ui').html('Authorizing...');
    client.authorize().then(function() {
      $('#ui').html('Fetching...');
      return client.users.me().then(function(me) {
        $('#ui').html('Hello ' + me.name + '!');
      });
    }).catch(function(err) {
      $('#ui').html('Error: ' + err);
    });
  }

  //]]>
</script>

</body>
</html>
